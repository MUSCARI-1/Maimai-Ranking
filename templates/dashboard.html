<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>λ§μ΄λ§μ΄ λ‚΄μμ© λ­ν‚Ή λ³΄λ“</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>π† λ§μ΄λ§μ΄ 1λ“± λ°©μ–΄μ „ ν„ν™©</h1>

    <div class="card">
        <div class="summary-container">
            <div class="summary-text">
                <h2>π”¥ μ μ €λ³„ νƒ€μ΄ν‹€ νλ“ μ</h2>
                <ul id="userSummaryList"></ul>
            </div>
            <div class="summary-chart">
                <p style="text-align:center; font-size:0.8em; color:#666; margin-bottom:0;">(μ΅°κ°μ„ ν΄λ¦­ν•λ©΄ ν•΄λ‹Ή κ³΅λ“¤λ§ λ¨μ•„λ³Ό μ μμµλ‹λ‹¤)</p>
                <canvas id="rankingChart"></canvas>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>πµ κ³΅λ³„ 1λ“± λ­ν‚Ή <span style="font-size: 0.6em; color:#666; font-weight:normal;">(ν‘λ¥Ό ν΄λ¦­ν•λ©΄ μƒμ„Έ μμ„λ¥Ό λ³Ό μ μμµλ‹λ‹¤)</span></h2>
        
        <div class="filter-container">
            <label for="levelFilter">λ³΄κΈ° μµμ…: </label>
            <select id="levelFilter" onchange="filterTable()">
                <option value="all">μ „μ²΄ λ λ²¨ λ³΄κΈ°</option>
            </select>
            <span id="chartFilterStatus" onclick="clearChartFilter()">β– μ°¨νΈ ν•„ν„° ν•΄μ </span>
        </div>

        <table id="scoreTable">
            <thead>
                <tr>
                    <th onclick="sortTable('song', 0)">κ³΅ μ΄λ¦„ <span class="sort-icon" id="icon-0"></span></th>
                    <th onclick="sortTable('level', 1)">λ λ²¨ <span class="sort-icon" id="icon-1"></span></th>
                    <th onclick="sortTable('user', 2)">1λ“± μ μ € <span class="sort-icon" id="icon-2"></span></th>
                    <th onclick="sortTable('score', 3)">μµκ³  μ μ <span class="sort-icon" id="icon-3"></span></th>
                </tr>
            </thead>
            <tbody id="scoreTableBody"></tbody>
        </table>
    </div>

    <div id="rankingModal" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 id="modalTitle">κ³΅ μ΄λ¦„ (Lv.?) λ­ν‚Ή</h3>
                <button class="modal-close" onclick="closeModal(event)">&times;</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th style="width: 20%;">μμ„</th>
                        <th style="width: 50%;">μ μ €</th>
                        <th style="width: 30%;">μ μ</th>
                    </tr>
                </thead>
                <tbody id="modalTableBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        // JS νμΌμ΄ μ½κΈ° μ „μ— νμ΄μ¬ λ°μ΄ν„°λ¥Ό μ „μ—­ λ³€μλ΅ λ¨Όμ € μ„ μ–Έν•΄μ¤λ‹λ‹¤.
        const allScores = {{top_scores_json|safe}};
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>